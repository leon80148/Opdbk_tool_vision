{
  "_comment": "Smart Action List è¦å‰‡å®šç¾©æª” - è¨ºæ‰€æ«ƒæª¯æ™ºæ…§åŠ©æ‰‹",
  "_version": "1.0",
  "_last_updated": "2025-11-22",
  "_description": "å®šç¾©è¡›æ•™æé†’ã€æª¢æŸ¥è¿½è¹¤ã€è³‡æ–™è£œå¡«ç­‰è¦å‰‡ï¼Œç”±è¦å‰‡å¼•æ“Žè©•ä¼°å¾Œç”¢ç”Ÿå¾…è¾¦äº‹é …æ¸…å–®",

  "rules": [
    {
      "id": "dm_education_critical",
      "name": "ç³–å°¿ç—…è¡›æ•™ï¼ˆé«˜é¢¨éšªï¼‰",
      "type": "education",
      "category": "DM",
      "priority": 1,
      "enabled": true,
      "condition": {
        "field": "HBA1C",
        "operator": ">=",
        "value": 9.0,
        "lookback_days": 180
      },
      "action": {
        "icon": "ðŸ”´",
        "color": "red",
        "title": "éœ€å®‰æŽ’ç³–å°¿ç—…è¡›æ•™ï¼ˆé«˜é¢¨éšªï¼‰",
        "message_template": "HBA1Cï¼š{value}%ï¼ˆæª¢é©—æ—¥ï¼š{date}ï¼‰ï¼Œå»ºè­°ç«‹å³å®‰æŽ’è¡›æ•™èˆ‡å›žè¨º",
        "suggested_actions": [
          "å®‰æŽ’è¡›æ•™å¸«è«®è©¢",
          "é–‹ç«‹ HBA1C è¿½è¹¤æª¢é©—å–®",
          "æé†’é†«å¸«èª¿æ•´ç”¨è—¥"
        ]
      }
    },
    {
      "id": "dm_education_warning",
      "name": "ç³–å°¿ç—…è¡›æ•™ï¼ˆéœ€æ³¨æ„ï¼‰",
      "type": "education",
      "category": "DM",
      "priority": 2,
      "enabled": true,
      "condition": {
        "field": "HBA1C",
        "operator": ">",
        "value": 7.0,
        "operator_and": "<",
        "value_and": 9.0,
        "lookback_days": 180
      },
      "action": {
        "icon": "ðŸŸ ",
        "color": "orange",
        "title": "éœ€å®‰æŽ’ç³–å°¿ç—…è¡›æ•™",
        "message_template": "HBA1Cï¼š{value}%ï¼ˆæª¢é©—æ—¥ï¼š{date}ï¼‰ï¼Œå»ºè­°å®‰æŽ’è¡›æ•™",
        "suggested_actions": [
          "å®‰æŽ’è¡›æ•™å¸«è«®è©¢",
          "æä¾›é£²é£ŸæŽ§åˆ¶è¡›æ•™å–®"
        ]
      }
    },
    {
      "id": "ckd_education",
      "name": "æ…¢æ€§è…Žè‡Ÿç—…è¡›æ•™",
      "type": "education",
      "category": "DM",
      "priority": 2,
      "enabled": true,
      "condition": {
        "field": "eGFR",
        "operator": "<",
        "value": 60,
        "lookback_days": 180
      },
      "action": {
        "icon": "ðŸŸ ",
        "color": "orange",
        "title": "éœ€å®‰æŽ’è…Žè‡Ÿç—…è¡›æ•™",
        "message_template": "eGFRï¼š{value} mL/min/1.73mÂ²ï¼ˆæª¢é©—æ—¥ï¼š{date}ï¼‰ï¼Œå»ºè­°å®‰æŽ’è…Žè‡Ÿç—…è¡›æ•™",
        "suggested_actions": [
          "å®‰æŽ’è…Žè‡Ÿç§‘æœƒè¨º",
          "æä¾›ä½Žè›‹ç™½é£²é£Ÿè¡›æ•™å–®",
          "æé†’é¿å…è…Žæ¯’æ€§è—¥ç‰©"
        ]
      }
    },
    {
      "id": "hyperlipidemia_education",
      "name": "é«˜è¡€è„‚è¡›æ•™",
      "type": "education",
      "category": "HTN_LIP",
      "priority": 3,
      "enabled": true,
      "condition": {
        "logic": "OR",
        "conditions": [
          {
            "field": "CHOL",
            "operator": ">=",
            "value": 240
          },
          {
            "field": "LDL",
            "operator": ">=",
            "value": 160
          },
          {
            "field": "TG",
            "operator": ">=",
            "value": 200
          }
        ],
        "lookback_days": 180
      },
      "action": {
        "icon": "ðŸŸ¡",
        "color": "orange",
        "title": "éœ€å®‰æŽ’é«˜è¡€è„‚è¡›æ•™",
        "message_template": "è¡€è„‚ç•°å¸¸ï¼ˆæª¢é©—æ—¥ï¼š{date}ï¼‰ï¼Œå»ºè­°å®‰æŽ’é£²é£Ÿèˆ‡ç”¨è—¥è¡›æ•™",
        "suggested_actions": [
          "æä¾›ä½Žæ²¹é£²é£Ÿè¡›æ•™å–®",
          "ç¢ºèªé™è¡€è„‚è—¥ç‰©é †å¾žæ€§"
        ]
      }
    },
    {
      "id": "hcv_followup",
      "name": "Cåž‹è‚ç‚Žé™½æ€§è¿½è¹¤",
      "type": "education",
      "category": "VIRUS",
      "priority": 1,
      "enabled": true,
      "condition": {
        "field": "AntiHCV",
        "operator": "==",
        "value": "Reactive"
      },
      "action": {
        "icon": "ðŸ”´",
        "color": "red",
        "title": "Cåž‹è‚ç‚Žé™½æ€§ï¼Œéœ€è¿½è¹¤æ²»ç™‚",
        "message_template": "Anti-HCVï¼šReactiveï¼ˆæª¢é©—æ—¥ï¼š{date}ï¼‰ï¼Œå»ºè­°è½‰ä»‹è‚è†½ç§‘è©•ä¼°æ²»ç™‚",
        "suggested_actions": [
          "å®‰æŽ’è‚è†½ç§‘æœƒè¨º",
          "é–‹ç«‹ HCV RNA æª¢é©—å–®",
          "æä¾›è‚ç‚Žè¡›æ•™å–®"
        ]
      }
    },
    {
      "id": "hbv_followup",
      "name": "Båž‹è‚ç‚Žå¸¶åŽŸè¿½è¹¤",
      "type": "education",
      "category": "VIRUS",
      "priority": 2,
      "enabled": true,
      "condition": {
        "field": "HBsAg",
        "operator": "==",
        "value": "Reactive"
      },
      "action": {
        "icon": "ðŸŸ ",
        "color": "orange",
        "title": "Båž‹è‚ç‚Žå¸¶åŽŸï¼Œéœ€å®šæœŸè¿½è¹¤",
        "message_template": "HBsAgï¼šReactiveï¼ˆæª¢é©—æ—¥ï¼š{date}ï¼‰ï¼Œå»ºè­°æ¯ 6 å€‹æœˆè¿½è¹¤è‚åŠŸèƒ½èˆ‡è…¹éƒ¨è¶…éŸ³æ³¢",
        "suggested_actions": [
          "é–‹ç«‹ GOT/GPT æª¢é©—å–®",
          "å®‰æŽ’è…¹éƒ¨è¶…éŸ³æ³¢",
          "æä¾›è‚ç‚Žè¡›æ•™å–®"
        ]
      }
    },
    {
      "id": "ultrasound_overdue",
      "name": "è…¹éƒ¨è¶…éŸ³æ³¢é€¾æœŸ",
      "type": "exam_tracking",
      "category": "EXAM",
      "priority": 2,
      "enabled": true,
      "condition": {
        "exam_type": "AbdomenUltrasound",
        "days_since_last_exam": ">",
        "value": 365,
        "source_table": "CO02M",
        "source_field": "dno",
        "exam_codes": ["US001", "US002", "è¶…éŸ³æ³¢"]
      },
      "action": {
        "icon": "ðŸ”µ",
        "color": "blue",
        "title": "è…¹éƒ¨è¶…éŸ³æ³¢å·²é€¾æœŸ",
        "message_template": "ä¸Šæ¬¡æª¢æŸ¥ï¼š{last_exam_date}ï¼Œå·²é€¾ {days_overdue} å¤©ï¼ˆå»ºè­°é€±æœŸï¼š1 å¹´ï¼‰",
        "suggested_actions": [
          "å®‰æŽ’è…¹éƒ¨è¶…éŸ³æ³¢æª¢æŸ¥",
          "ç¢ºèªæ˜¯å¦æœ‰è‚ç‚Žå¸¶åŽŸæˆ–è‚ç¡¬åŒ–ç—…å²"
        ]
      }
    },
    {
      "id": "gastroscopy_overdue",
      "name": "èƒƒé¡é€¾æœŸ",
      "type": "exam_tracking",
      "category": "EXAM",
      "priority": 3,
      "enabled": true,
      "condition": {
        "exam_type": "Gastroscopy",
        "days_since_last_exam": ">",
        "value": 730,
        "source_table": "CO02M",
        "source_field": "dno",
        "exam_codes": ["GS001", "èƒƒé¡", "ä¸Šæ¶ˆåŒ–é“å…§è¦–é¡"]
      },
      "action": {
        "icon": "ðŸ”µ",
        "color": "blue",
        "title": "èƒƒé¡å·²é€¾æœŸ",
        "message_template": "ä¸Šæ¬¡æª¢æŸ¥ï¼š{last_exam_date}ï¼Œå·²é€¾ {days_overdue} å¤©ï¼ˆå»ºè­°é€±æœŸï¼š2 å¹´ï¼‰",
        "suggested_actions": [
          "å®‰æŽ’èƒƒé¡æª¢æŸ¥",
          "ç¢ºèªæ˜¯å¦æœ‰èƒƒé£Ÿé“é€†æµæˆ–èƒƒæ½°ç˜ç—…å²"
        ]
      }
    },
    {
      "id": "colonoscopy_overdue",
      "name": "å¤§è…¸é¡é€¾æœŸ",
      "type": "exam_tracking",
      "category": "EXAM",
      "priority": 3,
      "enabled": true,
      "condition": {
        "exam_type": "Colonoscopy",
        "days_since_last_exam": ">",
        "value": 1825,
        "source_table": "CO02M",
        "source_field": "dno",
        "exam_codes": ["CS001", "å¤§è…¸é¡", "ä¸‹æ¶ˆåŒ–é“å…§è¦–é¡"]
      },
      "action": {
        "icon": "ðŸ”µ",
        "color": "blue",
        "title": "å¤§è…¸é¡å·²é€¾æœŸ",
        "message_template": "ä¸Šæ¬¡æª¢æŸ¥ï¼š{last_exam_date}ï¼Œå·²é€¾ {days_overdue} å¤©ï¼ˆå»ºè­°é€±æœŸï¼š5 å¹´ï¼‰",
        "suggested_actions": [
          "å®‰æŽ’å¤§è…¸é¡æª¢æŸ¥",
          "ç¢ºèªæ˜¯å¦æœ‰å¤§è…¸ç˜œè‚‰æˆ–å®¶æ—å²"
        ]
      }
    },
    {
      "id": "zostavax_recommendation",
      "name": "å»ºè­°æ–½æ‰“å¸¶ç‹€çš°ç–¹ç–«è‹—",
      "type": "vaccine_promotion",
      "category": "VACCINE",
      "priority": 4,
      "enabled": true,
      "condition": {
        "patient_age": ">=",
        "value": 50,
        "vaccine_code": "Zostavax",
        "not_received_within_years": 5,
        "source_table": "CO02M",
        "source_field": "dno"
      },
      "action": {
        "icon": "ðŸ’‰",
        "color": "green",
        "title": "å»ºè­°æ–½æ‰“å¸¶ç‹€çš°ç–¹ç–«è‹—",
        "message_template": "ç—…æ‚£å¹´é½¡ {age} æ­²ï¼Œå»ºè­°æ–½æ‰“å¸¶ç‹€çš°ç–¹ç–«è‹—ï¼ˆZostavaxï¼‰",
        "suggested_actions": [
          "èªªæ˜Žç–«è‹—æ•ˆç›Šèˆ‡è‡ªè²»åƒ¹æ ¼",
          "ç¢ºèªæ˜¯å¦æœ‰å…ç–«æŠ‘åˆ¶ç¦å¿Œç—‡"
        ]
      }
    },
    {
      "id": "prevenar_recommendation",
      "name": "å»ºè­°æ–½æ‰“è‚ºç‚ŽéˆçƒèŒç–«è‹—",
      "type": "vaccine_promotion",
      "category": "VACCINE",
      "priority": 4,
      "enabled": true,
      "condition": {
        "patient_age": ">=",
        "value": 65,
        "vaccine_code": "Prevenar",
        "not_received_within_years": 5,
        "source_table": "CO02M",
        "source_field": "dno"
      },
      "action": {
        "icon": "ðŸ’‰",
        "color": "green",
        "title": "å»ºè­°æ–½æ‰“è‚ºç‚ŽéˆçƒèŒç–«è‹—",
        "message_template": "ç—…æ‚£å¹´é½¡ {age} æ­²ï¼Œå»ºè­°æ–½æ‰“è‚ºç‚ŽéˆçƒèŒç–«è‹—ï¼ˆPrevenarï¼‰",
        "suggested_actions": [
          "èªªæ˜Žç–«è‹—æ•ˆç›Šèˆ‡å…¬è²»/è‡ªè²»è³‡æ ¼",
          "ç¢ºèªæ˜¯å¦æœ‰æ…¢æ€§ç—…å²ï¼ˆç³–å°¿ç—…ã€å¿ƒè‡Ÿç—…ï¼‰"
        ]
      }
    },
    {
      "id": "contact_info_incomplete",
      "name": "è¯çµ¡è³‡æ–™ä¸å®Œæ•´",
      "type": "data_completion",
      "category": "PATIENT_INFO",
      "priority": 5,
      "enabled": true,
      "condition": {
        "logic": "OR",
        "conditions": [
          {
            "field": "mtelh",
            "operator": "IS_NULL_OR_EMPTY"
          },
          {
            "field": "maddr",
            "operator": "IS_NULL_OR_EMPTY"
          }
        ],
        "source_table": "CO01M"
      },
      "action": {
        "icon": "ðŸŸ¡",
        "color": "orange",
        "title": "è¯çµ¡è³‡æ–™ä¸å®Œæ•´",
        "message_template": "ç¼ºå°‘ï¼š{missing_fields}ï¼Œè«‹å”åŠ©ç—…æ‚£è£œå¡«",
        "suggested_actions": [
          "è©¢å•ç—…æ‚£æ‰‹æ©Ÿè™Ÿç¢¼",
          "è©¢å•ç—…æ‚£å±…ä½åœ°å€",
          "æ›´æ–° HIS ç³»çµ±ç—…æ‚£è³‡æ–™"
        ]
      }
    },
    {
      "id": "address_incomplete",
      "name": "åœ°å€è³‡æ–™ä¸å®Œæ•´",
      "type": "data_completion",
      "category": "PATIENT_INFO",
      "priority": 6,
      "enabled": true,
      "condition": {
        "field": "maddr",
        "operator": "IS_NULL_OR_EMPTY",
        "source_table": "CO01M"
      },
      "action": {
        "icon": "âšª",
        "color": "gray",
        "title": "è«‹è£œå¡«åœ°å€è³‡æ–™",
        "message_template": "ç—…æ‚£åœ°å€æ¬„ä½ç‚ºç©ºï¼Œè«‹å”åŠ©è£œå¡«",
        "suggested_actions": [
          "è©¢å•ç—…æ‚£å±…ä½åœ°å€",
          "æ›´æ–° HIS ç³»çµ±"
        ]
      }
    },
    {
      "id": "phone_incomplete",
      "name": "é›»è©±è³‡æ–™ä¸å®Œæ•´",
      "type": "data_completion",
      "category": "PATIENT_INFO",
      "priority": 6,
      "enabled": true,
      "condition": {
        "field": "mtelh",
        "operator": "IS_NULL_OR_EMPTY",
        "source_table": "CO01M"
      },
      "action": {
        "icon": "âšª",
        "color": "gray",
        "title": "è«‹è£œå¡«æ‰‹æ©Ÿè™Ÿç¢¼",
        "message_template": "ç—…æ‚£æ‰‹æ©Ÿæ¬„ä½ç‚ºç©ºï¼Œè«‹å”åŠ©è£œå¡«",
        "suggested_actions": [
          "è©¢å•ç—…æ‚£æ‰‹æ©Ÿè™Ÿç¢¼",
          "æ›´æ–° HIS ç³»çµ±"
        ]
      }
    }
  ],

  "_rule_execution_order": {
    "description": "è¦å‰‡è©•ä¼°é †åºç”± priority æ±ºå®šï¼ˆæ•¸å­—è¶Šå°å„ªå…ˆç´šè¶Šé«˜ï¼‰",
    "priority_levels": {
      "1": "Critical - ç«‹å³éœ€è¦è™•ç†ï¼ˆç´…è‰²è­¦ç¤ºï¼‰",
      "2": "High - é«˜å„ªå…ˆç´šï¼ˆæ©˜è‰²è­¦ç¤ºï¼‰",
      "3": "Medium - ä¸­å„ªå…ˆç´šï¼ˆè—è‰²/é»ƒè‰²ï¼‰",
      "4": "Low - ä½Žå„ªå…ˆç´šï¼ˆç¶ è‰²æç¤ºï¼‰",
      "5-6": "Info - è³‡è¨Šæ€§æç¤ºï¼ˆç°è‰²ï¼‰"
    }
  },

  "_operator_reference": {
    "comparison_operators": {
      "==": "ç­‰æ–¼",
      "!=": "ä¸ç­‰æ–¼",
      ">": "å¤§æ–¼",
      ">=": "å¤§æ–¼ç­‰æ–¼",
      "<": "å°æ–¼",
      "<=": "å°æ–¼ç­‰æ–¼"
    },
    "special_operators": {
      "IS_NULL_OR_EMPTY": "æ¬„ä½ç‚ºç©ºæˆ– NULL",
      "IS_NOT_NULL": "æ¬„ä½æœ‰å€¼",
      "CONTAINS": "åŒ…å«ï¼ˆå­—ä¸²ï¼‰",
      "NOT_CONTAINS": "ä¸åŒ…å«ï¼ˆå­—ä¸²ï¼‰",
      "IN": "åœ¨åˆ—è¡¨ä¸­",
      "NOT_IN": "ä¸åœ¨åˆ—è¡¨ä¸­"
    },
    "logic_operators": {
      "AND": "æ‰€æœ‰æ¢ä»¶éƒ½å¿…é ˆç¬¦åˆ",
      "OR": "ä»»ä¸€æ¢ä»¶ç¬¦åˆå³å¯"
    }
  },

  "_condition_fields_mapping": {
    "lab_values": {
      "HBA1C": "lab_results_wide.hba1c",
      "eGFR": "lab_results_wide.egfr",
      "CHOL": "lab_results_wide.chol",
      "LDL": "lab_results_wide.ldl_c",
      "TG": "lab_results_wide.tg",
      "AntiHCV": "lab_results_wide.anti_hcv",
      "HBsAg": "lab_results_wide.hbsag"
    },
    "patient_info": {
      "mtelh": "CO01M.mtelh",
      "maddr": "CO01M.maddr",
      "patient_age": "calculated from CO01M.mbirthdt"
    },
    "exam_tracking": {
      "last_exam_date": "MAX(CO02M.idate) WHERE dno IN exam_codes",
      "days_since_last_exam": "DATEDIFF(TODAY, last_exam_date)"
    }
  },

  "_implementation_notes": {
    "lookback_days": "å¾žä»Šå¤©å¾€å›žæŽ¨ç®— N å¤©å…§çš„æª¢é©—è³‡æ–™ï¼Œé¿å…ä½¿ç”¨éŽèˆŠçš„æ•¸æ“š",
    "exam_codes": "å¯¦éš›æª¢æŸ¥ä»£ç¢¼éœ€ä¾è¨ºæ‰€ HIS ç³»çµ±èª¿æ•´ï¼Œå¯èƒ½ç‚ºæ•¸å­—ä»£ç¢¼æˆ–ä¸­æ–‡åç¨±",
    "message_template": "ä½¿ç”¨ {variable} èªžæ³•æ’å…¥å‹•æ…‹è³‡æ–™ï¼Œä¾‹å¦‚ {value}ã€{date}ã€{age}",
    "suggested_actions": "åƒ…ä¾›æ«ƒæª¯åƒè€ƒï¼Œä¸æœƒè‡ªå‹•åŸ·è¡Œ",
    "enabled": "å¯åœç”¨ç‰¹å®šè¦å‰‡è€Œä¸éœ€åˆªé™¤å®šç¾©ï¼Œæ–¹ä¾¿æ¸¬è©¦èˆ‡èª¿æ•´"
  }
}
